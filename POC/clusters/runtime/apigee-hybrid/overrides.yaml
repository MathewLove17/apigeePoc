# =========================================================
# Apigee Hybrid 1.16 - AKS PoC overrides
# =========================================================

instanceID: poc-apigee-runtime
namespace: apigee

org: pocapigee-485810

gcp:
  projectID: pocapigee-485810
  region: europe-west1

k8sCluster:
  name: clusterapigee
  region: spaincentral

# =========================================================
# AKS: eliminar restricciones de scheduling (GKE defaults)
# =========================================================
nodeSelector: {}
affinity: {}
tolerations: []

# =========================================================
# Guardrails: operator exige path al JSON montado
# Secret: apigee-operator-guardrails-svc-account
# Key:    gcp-creds.json
# =========================================================
guardrails:
  serviceAccountPath: /var/secrets/google/gcp-creds.json
  nodeSelector: {}
  affinity: {}
  tolerations: []

# En algunos charts el "guardrail ingress manager" cuelga de ingressManager
ingressManager:
  nodeSelector: {}
  affinity: {}
  tolerations: []

# En otros charts los nombres cambian; estos bloques extra no molestan
apigeeOperator:
  nodeSelector: {}
  affinity: {}
  tolerations: []

apigeeIngressManager:
  nodeSelector: {}
  affinity: {}
  tolerations: []

# =========================================================
# Entorno(s) y Service Account (desde ExternalSecrets)
# Secret: gcp-sa-json (key gcp-creds.json)
# =========================================================
envs:
  - name: test
    serviceAccountSecretRefs:
      synchronizer: gcp-sa-json
      runtime: gcp-sa-json

# =========================================================
# Cassandra (PoC)
# =========================================================
cassandra:
  hostNetwork: false
  replicaCount: 1
  nodeSelector: {}
  affinity: {}
  tolerations: []

# =========================================================
# Ingress + Virtualhost
# =========================================================
ingressGateways:
  - name: apigee-ingress
    replicaCountMin: 1
    replicaCountMax: 2

virtualhosts:
  - name: hybrid-group
    selector:
      app: apigee-ingressgateway
    ingress_name: apigee-ingress
    sslCertPath: certs/tls.crt
    sslKeyPath: certs/tls.key

# =========================================================
# Componentes que publican en control plane
# =========================================================
mart:
  serviceAccountRef: gcp-sa-json

connectAgent:
  serviceAccountRef: gcp-sa-json

logger:
  enabled: true
  serviceAccountRef: gcp-sa-json

metrics:
  serviceAccountRef: gcp-sa-json

watcher:
  serviceAccountRef: gcp-sa-json

# =========================================================
# Runtime
# =========================================================
runtime:
  image:
    uri: gcr.io/apigee-release/hybrid/apigee-runtime
    tag: "1.16.0"
