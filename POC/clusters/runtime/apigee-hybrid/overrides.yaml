# ============================================================
# Apigee Hybrid 1.16 - overrides.yaml (basado en plantilla oficial)
# Target: AKS / PoC / ArgoCD / External Secrets
# ============================================================

instanceID: poc-apigee-aks
namespace: apigee

gcp:
  projectID: pocapigee-485810
  region: europe-west1

k8sCluster:
  name: clusterapigee
  # en AKS esto es orientativo para analytics/nearest region
  region: westeurope

org: pocapigee-485810

# ---------------------------
# Entorno
# ---------------------------
envs:
  - name: test
    serviceAccountSecretRefs:
      # En no-prod puedes usar el mismo secret para todo si quieres (POC)
      synchronizer: gcp-sa-json
      runtime: gcp-sa-json

# ---------------------------
# Cassandra (POC)
# ---------------------------
cassandra:
  hostNetwork: false
  replicaCount: 1

# ---------------------------
# Ingress Gateway
# ---------------------------
ingressGateways:
  - name: hybrid-ingress
    replicaCountMin: 1
    replicaCountMax: 2
    svcAnnotations: {}

# ---------------------------
# Virtualhosts (EnvGroup)
# envgroup = hybrid-group (lo que tú ya tienes)
# ---------------------------
virtualhosts:
  - name: hybrid-group
    selector:
      app: apigee-ingressgateway
    ingress_name: hybrid-ingress
    sslCertPath: certs/tls.crt
    sslKeyPath: certs/tls.key

# ---------------------------
# ServiceAccount secrets (desde ExternalSecrets)
# ---------------------------
guardrails:
  # OJO: aquí la plantilla oficial usa serviceAccountRef (secret name)
  # Tú ya tienes el secret "apigee-operator-guardrails-svc-account" pero
  # por ESO te está dejando dentro la key gcp-creds.json
  serviceAccountRef: apigee-operator-guardrails-svc-account

mart:
  serviceAccountRef: gcp-sa-json

connectAgent:
  serviceAccountRef: gcp-sa-json

logger:
  enabled: true
  serviceAccountRef: gcp-sa-json

metrics:
  serviceAccountRef: gcp-sa-json

watcher:
  serviceAccountRef: gcp-sa-json

# ---------------------------
# Runtime
# ---------------------------
runtime:
  image:
    uri: "gcr.io/apigee-release/hybrid/apigee-runtime"
    tag: "1.16.0"
  # sizing POC (si quieres lo ajustamos luego)
  #cwcAppend:
  #  resources:
  #    requests:
  #      memory: 4Gi
  #    limits:
  #      memory: 6Gi
